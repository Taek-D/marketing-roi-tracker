<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarketingROI Tracker - Interactive Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f0f2f5;
            color: #202124;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%);
            color: white;
            padding: 28px 40px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .header h1 { font-size: 24px; font-weight: 600; letter-spacing: -0.3px; }
        .header-meta {
            display: flex;
            gap: 24px;
            margin-top: 6px;
            font-size: 13px;
            opacity: 0.85;
        }

        /* Layout */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 24px;
        }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }
        .kpi-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
            transition: transform 0.15s, box-shadow 0.15s;
        }
        .kpi-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .kpi-card.highlight {
            background: #e8f0fe;
            border: 1px solid #c6dafc;
        }
        .kpi-value {
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        .kpi-card.highlight .kpi-value { color: #1a73e8; }
        .kpi-label {
            font-size: 11px;
            color: #5f6368;
            margin-top: 6px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        /* Chart Sections */
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        }
        .chart-card.full {
            grid-column: 1 / -1;
        }
        .chart-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .chart-title .badge {
            font-size: 10px;
            background: #e8f0fe;
            color: #1a73e8;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 500;
        }
        .chart-container {
            position: relative;
            width: 100%;
        }
        .chart-container.tall { height: 380px; }
        .chart-container.medium { height: 320px; }
        .chart-container.short { height: 280px; }

        /* Table */
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border: 1px solid #e8eaed;
            border-radius: 8px;
            overflow: hidden;
            font-size: 14px;
        }
        .data-table th {
            background: #f8f9fa;
            color: #5f6368;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            font-weight: 600;
            padding: 12px 14px;
            text-align: left;
            border-bottom: 1px solid #e8eaed;
        }
        .data-table td {
            padding: 12px 14px;
            border-bottom: 1px solid #f1f3f4;
        }
        .data-table tr:last-child td { border-bottom: none; }
        .data-table td.num { text-align: right; font-variant-numeric: tabular-nums; }
        .tag {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        .tag-best { background: #e6f4ea; color: #137333; }
        .tag-good { background: #e8f0fe; color: #1967d2; }
        .tag-warn { background: #fce8e6; color: #c5221f; }

        /* Footer */
        .footer {
            text-align: center;
            padding: 24px;
            font-size: 12px;
            color: #80868b;
        }
        .footer a { color: #1a73e8; text-decoration: none; }

        /* Data badge */
        .data-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #fef7e0;
            border: 1px solid #fdd663;
            border-radius: 6px;
            padding: 8px 14px;
            font-size: 12px;
            color: #795548;
            margin-bottom: 20px;
        }
        .data-badge strong { color: #5d4037; }

        /* Responsive */
        @media (max-width: 900px) {
            .kpi-grid { grid-template-columns: repeat(2, 1fr); }
            .chart-row { grid-template-columns: 1fr; }
            .container { padding: 16px; }
        }
        @media (max-width: 500px) {
            .kpi-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>MarketingROI Tracker Dashboard</h1>
        <div class="header-meta">
            <span>Period: 2024-10-01 ~ 2024-12-29 (90 days)</span>
            <span>Channels: Google Ads, Facebook Ads, Naver Ads</span>
            <span>Data: 810 rows (3 channels x 3 campaigns x 90 days)</span>
        </div>
    </div>

    <div class="container">
        <!-- Data Badge -->
        <div class="data-badge">
            <strong>Data Source:</strong> generate_data.py (12 marketing patterns, seed=42) | Supabase PostgreSQL
        </div>

        <!-- KPI Cards -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-value">$164,170</div>
                <div class="kpi-label">Total Spend</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">$437,128</div>
                <div class="kpi-label">Total Revenue</div>
            </div>
            <div class="kpi-card highlight">
                <div class="kpi-value">2.66</div>
                <div class="kpi-label">Avg ROAS</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">31,481</div>
                <div class="kpi-label">Total Conversions</div>
            </div>
        </div>

        <!-- Row 1: ROAS Bar + Revenue Pie -->
        <div class="chart-row">
            <div class="chart-card">
                <div class="chart-title">Channel ROAS Comparison <span class="badge">Interactive</span></div>
                <div class="chart-container medium">
                    <canvas id="roasBarChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-title">Revenue Share by Channel <span class="badge">Interactive</span></div>
                <div class="chart-container medium">
                    <canvas id="revenuePieChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Row 2: Daily ROAS Line (Full Width) -->
        <div class="chart-row">
            <div class="chart-card full">
                <div class="chart-title">Daily ROAS Trend + 7-Day Moving Average <span class="badge">90 Days</span></div>
                <div class="chart-container tall">
                    <canvas id="roasLineChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Row 3: Campaign Matrix + Funnel Table -->
        <div class="chart-row">
            <div class="chart-card">
                <div class="chart-title">Campaign Performance (Cost vs Revenue) <span class="badge">Bubble</span></div>
                <div class="chart-container medium">
                    <canvas id="campaignBubbleChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-title">Funnel Metrics by Channel</div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Channel</th>
                            <th>CTR (%)</th>
                            <th>CVR (%)</th>
                            <th>CPA ($)</th>
                            <th>ROAS</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color:#03c75a">Naver Ads</strong></td>
                            <td class="num">5.20</td>
                            <td class="num">5.36</td>
                            <td class="num">3.98</td>
                            <td class="num"><strong>3.26</strong></td>
                            <td><span class="tag tag-best">Best</span></td>
                        </tr>
                        <tr>
                            <td><strong style="color:#4285f4">Google Ads</strong></td>
                            <td class="num">4.92</td>
                            <td class="num">4.51</td>
                            <td class="num">4.85</td>
                            <td class="num"><strong>2.76</strong></td>
                            <td><span class="tag tag-good">Good</span></td>
                        </tr>
                        <tr>
                            <td><strong style="color:#1877f2">Facebook Ads</strong></td>
                            <td class="num">3.94</td>
                            <td class="num">3.62</td>
                            <td class="num">8.02</td>
                            <td class="num"><strong>2.03</strong></td>
                            <td><span class="tag tag-warn">Improve</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>MarketingROI Tracker v0.7.0 | Google Apps Script + Supabase PostgreSQL</p>
        <p>Built with Chart.js | <a href="https://github.com/Taek-D/marketing-roi-tracker" target="_blank">GitHub Repository</a></p>
    </div>

    <script>
    // ===== DATA =====
    const COLORS = {
        google: { bg: '#4285f4', border: '#3367d6', light: 'rgba(66,133,244,0.15)' },
        facebook: { bg: '#1877f2', border: '#1664d9', light: 'rgba(24,119,242,0.15)' },
        naver: { bg: '#03c75a', border: '#02a84c', light: 'rgba(3,199,90,0.15)' }
    };

    const dailyData = [{"d":"2024-10-01","c":"Google","r":2.49,"m":2.49},{"d":"2024-10-01","c":"Facebook","r":1.85,"m":1.85},{"d":"2024-10-01","c":"Naver","r":2.82,"m":2.82},{"d":"2024-10-02","c":"Google","r":3.11,"m":2.8},{"d":"2024-10-02","c":"Facebook","r":1.82,"m":1.83},{"d":"2024-10-02","c":"Naver","r":3.04,"m":2.93},{"d":"2024-10-03","c":"Google","r":2.53,"m":2.71},{"d":"2024-10-03","c":"Facebook","r":2.38,"m":2.02},{"d":"2024-10-03","c":"Naver","r":3.43,"m":3.1},{"d":"2024-10-04","c":"Google","r":2.84,"m":2.74},{"d":"2024-10-04","c":"Facebook","r":1.96,"m":2.0},{"d":"2024-10-04","c":"Naver","r":3.09,"m":3.09},{"d":"2024-10-05","c":"Google","r":2.95,"m":2.78},{"d":"2024-10-05","c":"Facebook","r":2.1,"m":2.02},{"d":"2024-10-05","c":"Naver","r":3.35,"m":3.15},{"d":"2024-10-06","c":"Google","r":2.45,"m":2.73},{"d":"2024-10-06","c":"Facebook","r":1.83,"m":1.99},{"d":"2024-10-06","c":"Naver","r":3.07,"m":3.13},{"d":"2024-10-07","c":"Google","r":2.95,"m":2.76},{"d":"2024-10-07","c":"Facebook","r":2.07,"m":2.0},{"d":"2024-10-07","c":"Naver","r":3.39,"m":3.17},{"d":"2024-10-08","c":"Google","r":2.54,"m":2.77},{"d":"2024-10-08","c":"Facebook","r":1.83,"m":2.0},{"d":"2024-10-08","c":"Naver","r":3.53,"m":3.27},{"d":"2024-10-09","c":"Google","r":2.63,"m":2.7},{"d":"2024-10-09","c":"Facebook","r":1.96,"m":2.02},{"d":"2024-10-09","c":"Naver","r":2.87,"m":3.25},{"d":"2024-10-10","c":"Google","r":2.42,"m":2.68},{"d":"2024-10-10","c":"Facebook","r":2.15,"m":1.99},{"d":"2024-10-10","c":"Naver","r":2.75,"m":3.15},{"d":"2024-10-11","c":"Google","r":3.11,"m":2.72},{"d":"2024-10-11","c":"Facebook","r":1.68,"m":1.95},{"d":"2024-10-11","c":"Naver","r":3.12,"m":3.15},{"d":"2024-10-12","c":"Google","r":2.22,"m":2.62},{"d":"2024-10-12","c":"Facebook","r":1.85,"m":1.91},{"d":"2024-10-12","c":"Naver","r":3.77,"m":3.21},{"d":"2024-10-13","c":"Google","r":2.73,"m":2.66},{"d":"2024-10-13","c":"Facebook","r":1.87,"m":1.92},{"d":"2024-10-13","c":"Naver","r":3.72,"m":3.31},{"d":"2024-10-14","c":"Google","r":2.8,"m":2.64},{"d":"2024-10-14","c":"Facebook","r":2.32,"m":1.95},{"d":"2024-10-14","c":"Naver","r":2.95,"m":3.24},{"d":"2024-10-15","c":"Google","r":2.88,"m":2.68},{"d":"2024-10-15","c":"Facebook","r":2.26,"m":2.01},{"d":"2024-10-15","c":"Naver","r":2.42,"m":3.09},{"d":"2024-10-16","c":"Google","r":2.41,"m":2.65},{"d":"2024-10-16","c":"Facebook","r":2.12,"m":2.04},{"d":"2024-10-16","c":"Naver","r":2.53,"m":3.04},{"d":"2024-10-17","c":"Google","r":2.55,"m":2.67},{"d":"2024-10-17","c":"Facebook","r":1.74,"m":1.98},{"d":"2024-10-17","c":"Naver","r":3.59,"m":3.16},{"d":"2024-10-18","c":"Google","r":2.75,"m":2.62},{"d":"2024-10-18","c":"Facebook","r":2.1,"m":2.04},{"d":"2024-10-18","c":"Naver","r":3.61,"m":3.23},{"d":"2024-10-19","c":"Google","r":2.69,"m":2.69},{"d":"2024-10-19","c":"Facebook","r":1.72,"m":2.02},{"d":"2024-10-19","c":"Naver","r":3.37,"m":3.17},{"d":"2024-10-20","c":"Google","r":3.08,"m":2.74},{"d":"2024-10-20","c":"Facebook","r":1.85,"m":2.02},{"d":"2024-10-20","c":"Naver","r":2.59,"m":3.01},{"d":"2024-10-21","c":"Google","r":2.67,"m":2.72},{"d":"2024-10-21","c":"Facebook","r":1.9,"m":1.96},{"d":"2024-10-21","c":"Naver","r":3.04,"m":3.02},{"d":"2024-10-22","c":"Google","r":2.06,"m":2.6},{"d":"2024-10-22","c":"Facebook","r":2.25,"m":1.95},{"d":"2024-10-22","c":"Naver","r":3.34,"m":3.15},{"d":"2024-10-23","c":"Google","r":2.7,"m":2.64},{"d":"2024-10-23","c":"Facebook","r":1.96,"m":1.93},{"d":"2024-10-23","c":"Naver","r":2.81,"m":3.19},{"d":"2024-10-24","c":"Google","r":2.76,"m":2.67},{"d":"2024-10-24","c":"Facebook","r":2.12,"m":1.99},{"d":"2024-10-24","c":"Naver","r":2.9,"m":3.09},{"d":"2024-10-25","c":"Google","r":2.3,"m":2.61},{"d":"2024-10-25","c":"Facebook","r":2.12,"m":1.99},{"d":"2024-10-25","c":"Naver","r":2.93,"m":3.0},{"d":"2024-10-26","c":"Google","r":2.33,"m":2.56},{"d":"2024-10-26","c":"Facebook","r":2.22,"m":2.06},{"d":"2024-10-26","c":"Naver","r":2.74,"m":2.91},{"d":"2024-10-27","c":"Google","r":2.6,"m":2.49},{"d":"2024-10-27","c":"Facebook","r":1.64,"m":2.03},{"d":"2024-10-27","c":"Naver","r":2.99,"m":2.96},{"d":"2024-10-28","c":"Google","r":2.8,"m":2.51},{"d":"2024-10-28","c":"Facebook","r":1.96,"m":2.04},{"d":"2024-10-28","c":"Naver","r":3.57,"m":3.04},{"d":"2024-10-29","c":"Google","r":2.63,"m":2.59},{"d":"2024-10-29","c":"Facebook","r":2.05,"m":2.01},{"d":"2024-10-29","c":"Naver","r":3.66,"m":3.09},{"d":"2024-10-30","c":"Google","r":2.88,"m":2.61},{"d":"2024-10-30","c":"Facebook","r":1.99,"m":2.01},{"d":"2024-10-30","c":"Naver","r":3.4,"m":3.17},{"d":"2024-10-31","c":"Google","r":2.64,"m":2.6},{"d":"2024-10-31","c":"Facebook","r":1.87,"m":1.98},{"d":"2024-10-31","c":"Naver","r":2.98,"m":3.18},{"d":"2024-11-01","c":"Google","r":2.77,"m":2.66},{"d":"2024-11-01","c":"Facebook","r":2.08,"m":1.97},{"d":"2024-11-01","c":"Naver","r":3.17,"m":3.22},{"d":"2024-11-02","c":"Google","r":2.75,"m":2.72},{"d":"2024-11-02","c":"Facebook","r":1.95,"m":1.93},{"d":"2024-11-02","c":"Naver","r":2.82,"m":3.23},{"d":"2024-11-03","c":"Google","r":2.45,"m":2.7},{"d":"2024-11-03","c":"Facebook","r":2.04,"m":1.99},{"d":"2024-11-03","c":"Naver","r":3.3,"m":3.27},{"d":"2024-11-04","c":"Google","r":2.88,"m":2.71},{"d":"2024-11-04","c":"Facebook","r":1.85,"m":1.98},{"d":"2024-11-04","c":"Naver","r":2.84,"m":3.17},{"d":"2024-11-05","c":"Google","r":2.45,"m":2.69},{"d":"2024-11-05","c":"Facebook","r":2.0,"m":1.97},{"d":"2024-11-05","c":"Naver","r":3.32,"m":3.12},{"d":"2024-11-06","c":"Google","r":2.2,"m":2.59},{"d":"2024-11-06","c":"Facebook","r":1.9,"m":1.96},{"d":"2024-11-06","c":"Naver","r":3.26,"m":3.1},{"d":"2024-11-07","c":"Google","r":2.68,"m":2.6},{"d":"2024-11-07","c":"Facebook","r":2.0,"m":1.97},{"d":"2024-11-07","c":"Naver","r":4.05,"m":3.25},{"d":"2024-11-08","c":"Google","r":2.54,"m":2.56},{"d":"2024-11-08","c":"Facebook","r":2.1,"m":1.98},{"d":"2024-11-08","c":"Naver","r":3.26,"m":3.26},{"d":"2024-11-09","c":"Google","r":2.5,"m":2.53},{"d":"2024-11-09","c":"Facebook","r":1.81,"m":1.96},{"d":"2024-11-09","c":"Naver","r":3.11,"m":3.31},{"d":"2024-11-10","c":"Google","r":2.25,"m":2.5},{"d":"2024-11-10","c":"Facebook","r":1.98,"m":1.95},{"d":"2024-11-10","c":"Naver","r":3.48,"m":3.33},{"d":"2024-11-11","c":"Google","r":2.43,"m":2.44},{"d":"2024-11-11","c":"Facebook","r":1.83,"m":1.95},{"d":"2024-11-11","c":"Naver","r":2.85,"m":3.33},{"d":"2024-11-12","c":"Google","r":2.47,"m":2.44},{"d":"2024-11-12","c":"Facebook","r":2.13,"m":1.96},{"d":"2024-11-12","c":"Naver","r":3.35,"m":3.34},{"d":"2024-11-13","c":"Google","r":2.72,"m":2.51},{"d":"2024-11-13","c":"Facebook","r":2.02,"m":1.98},{"d":"2024-11-13","c":"Naver","r":3.45,"m":3.36},{"d":"2024-11-14","c":"Google","r":2.6,"m":2.5},{"d":"2024-11-14","c":"Facebook","r":2.12,"m":2.0},{"d":"2024-11-14","c":"Naver","r":3.3,"m":3.26},{"d":"2024-11-15","c":"Google","r":2.73,"m":2.53},{"d":"2024-11-15","c":"Facebook","r":1.87,"m":1.97},{"d":"2024-11-15","c":"Naver","r":3.77,"m":3.33},{"d":"2024-11-16","c":"Google","r":2.59,"m":2.54},{"d":"2024-11-16","c":"Facebook","r":1.85,"m":1.97},{"d":"2024-11-16","c":"Naver","r":3.15,"m":3.34},{"d":"2024-11-17","c":"Google","r":2.81,"m":2.62},{"d":"2024-11-17","c":"Facebook","r":2.16,"m":2.0},{"d":"2024-11-17","c":"Naver","r":4.17,"m":3.43},{"d":"2024-11-18","c":"Google","r":2.98,"m":2.7},{"d":"2024-11-18","c":"Facebook","r":1.63,"m":1.97},{"d":"2024-11-18","c":"Naver","r":2.78,"m":3.42},{"d":"2024-11-19","c":"Google","r":2.28,"m":2.67},{"d":"2024-11-19","c":"Facebook","r":2.09,"m":1.96},{"d":"2024-11-19","c":"Naver","r":2.89,"m":3.36},{"d":"2024-11-20","c":"Google","r":2.64,"m":2.66},{"d":"2024-11-20","c":"Facebook","r":2.05,"m":1.97},{"d":"2024-11-20","c":"Naver","r":3.3,"m":3.34},{"d":"2024-11-21","c":"Google","r":3.03,"m":2.72},{"d":"2024-11-21","c":"Facebook","r":1.97,"m":1.95},{"d":"2024-11-21","c":"Naver","r":3.42,"m":3.35},{"d":"2024-11-22","c":"Google","r":2.93,"m":2.75},{"d":"2024-11-22","c":"Facebook","r":2.31,"m":2.01},{"d":"2024-11-22","c":"Naver","r":3.0,"m":3.24},{"d":"2024-11-23","c":"Google","r":3.03,"m":2.81},{"d":"2024-11-23","c":"Facebook","r":1.89,"m":2.01},{"d":"2024-11-23","c":"Naver","r":3.08,"m":3.23},{"d":"2024-11-24","c":"Google","r":2.43,"m":2.76},{"d":"2024-11-24","c":"Facebook","r":1.92,"m":1.98},{"d":"2024-11-24","c":"Naver","r":2.7,"m":3.02},{"d":"2024-11-25","c":"Google","r":2.6,"m":2.71},{"d":"2024-11-25","c":"Facebook","r":1.95,"m":2.03},{"d":"2024-11-25","c":"Naver","r":2.93,"m":3.05},{"d":"2024-11-26","c":"Google","r":2.61,"m":2.75},{"d":"2024-11-26","c":"Facebook","r":2.24,"m":2.05},{"d":"2024-11-26","c":"Naver","r":3.05,"m":3.07},{"d":"2024-11-27","c":"Google","r":2.79,"m":2.77},{"d":"2024-11-27","c":"Facebook","r":2.03,"m":2.04},{"d":"2024-11-27","c":"Naver","r":3.15,"m":3.05},{"d":"2024-11-28","c":"Google","r":5.63,"m":3.15},{"d":"2024-11-28","c":"Facebook","r":4.1,"m":2.35},{"d":"2024-11-28","c":"Naver","r":4.95,"m":3.27},{"d":"2024-11-29","c":"Google","r":6.03,"m":3.59},{"d":"2024-11-29","c":"Facebook","r":4.27,"m":2.63},{"d":"2024-11-29","c":"Naver","r":6.5,"m":3.77},{"d":"2024-11-30","c":"Google","r":4.9,"m":3.86},{"d":"2024-11-30","c":"Facebook","r":3.62,"m":2.88},{"d":"2024-11-30","c":"Naver","r":5.0,"m":4.04},{"d":"2024-12-01","c":"Google","r":5.29,"m":4.26},{"d":"2024-12-01","c":"Facebook","r":3.84,"m":3.15},{"d":"2024-12-01","c":"Naver","r":6.32,"m":4.56},{"d":"2024-12-02","c":"Google","r":2.9,"m":4.31},{"d":"2024-12-02","c":"Facebook","r":1.94,"m":3.15},{"d":"2024-12-02","c":"Naver","r":2.71,"m":4.53},{"d":"2024-12-03","c":"Google","r":2.41,"m":4.28},{"d":"2024-12-03","c":"Facebook","r":2.02,"m":3.12},{"d":"2024-12-03","c":"Naver","r":2.97,"m":4.51},{"d":"2024-12-04","c":"Google","r":2.85,"m":4.29},{"d":"2024-12-04","c":"Facebook","r":2.34,"m":3.16},{"d":"2024-12-04","c":"Naver","r":2.89,"m":4.48},{"d":"2024-12-05","c":"Google","r":2.52,"m":3.84},{"d":"2024-12-05","c":"Facebook","r":2.02,"m":2.86},{"d":"2024-12-05","c":"Naver","r":3.26,"m":4.24},{"d":"2024-12-06","c":"Google","r":2.67,"m":3.36},{"d":"2024-12-06","c":"Facebook","r":1.63,"m":2.49},{"d":"2024-12-06","c":"Naver","r":3.14,"m":3.76},{"d":"2024-12-07","c":"Google","r":2.32,"m":2.99},{"d":"2024-12-07","c":"Facebook","r":1.8,"m":2.23},{"d":"2024-12-07","c":"Naver","r":3.29,"m":3.51},{"d":"2024-12-08","c":"Google","r":3.06,"m":2.68},{"d":"2024-12-08","c":"Facebook","r":1.89,"m":1.95},{"d":"2024-12-08","c":"Naver","r":3.17,"m":3.06},{"d":"2024-12-09","c":"Google","r":2.73,"m":2.65},{"d":"2024-12-09","c":"Facebook","r":1.72,"m":1.92},{"d":"2024-12-09","c":"Naver","r":3.29,"m":3.14},{"d":"2024-12-10","c":"Google","r":2.49,"m":2.66},{"d":"2024-12-10","c":"Facebook","r":2.24,"m":1.95},{"d":"2024-12-10","c":"Naver","r":3.33,"m":3.2},{"d":"2024-12-11","c":"Google","r":2.19,"m":2.57},{"d":"2024-12-11","c":"Facebook","r":1.86,"m":1.88},{"d":"2024-12-11","c":"Naver","r":3.02,"m":3.21},{"d":"2024-12-12","c":"Google","r":2.43,"m":2.56},{"d":"2024-12-12","c":"Facebook","r":2.09,"m":1.89},{"d":"2024-12-12","c":"Naver","r":2.69,"m":3.13},{"d":"2024-12-13","c":"Google","r":2.44,"m":2.52},{"d":"2024-12-13","c":"Facebook","r":2.0,"m":1.94},{"d":"2024-12-13","c":"Naver","r":3.42,"m":3.17},{"d":"2024-12-14","c":"Google","r":2.63,"m":2.57},{"d":"2024-12-14","c":"Facebook","r":1.68,"m":1.93},{"d":"2024-12-14","c":"Naver","r":3.52,"m":3.21},{"d":"2024-12-15","c":"Google","r":2.91,"m":2.55},{"d":"2024-12-15","c":"Facebook","r":1.65,"m":1.89},{"d":"2024-12-15","c":"Naver","r":3.12,"m":3.2},{"d":"2024-12-16","c":"Google","r":2.93,"m":2.57},{"d":"2024-12-16","c":"Facebook","r":1.82,"m":1.91},{"d":"2024-12-16","c":"Naver","r":3.29,"m":3.2},{"d":"2024-12-17","c":"Google","r":2.86,"m":2.63},{"d":"2024-12-17","c":"Facebook","r":1.81,"m":1.84},{"d":"2024-12-17","c":"Naver","r":2.91,"m":3.14},{"d":"2024-12-18","c":"Google","r":3.04,"m":2.75},{"d":"2024-12-18","c":"Facebook","r":0.51,"m":1.65},{"d":"2024-12-18","c":"Naver","r":2.98,"m":3.13},{"d":"2024-12-19","c":"Google","r":2.22,"m":2.72},{"d":"2024-12-19","c":"Facebook","r":0.44,"m":1.42},{"d":"2024-12-19","c":"Naver","r":2.97,"m":3.17},{"d":"2024-12-20","c":"Google","r":2.17,"m":2.68},{"d":"2024-12-20","c":"Facebook","r":1.96,"m":1.41},{"d":"2024-12-20","c":"Naver","r":2.46,"m":3.04},{"d":"2024-12-21","c":"Google","r":2.44,"m":2.65},{"d":"2024-12-21","c":"Facebook","r":2.09,"m":1.47},{"d":"2024-12-21","c":"Naver","r":2.4,"m":2.88},{"d":"2024-12-22","c":"Google","r":2.32,"m":2.57},{"d":"2024-12-22","c":"Facebook","r":1.99,"m":1.52},{"d":"2024-12-22","c":"Naver","r":3.15,"m":2.88},{"d":"2024-12-23","c":"Google","r":2.74,"m":2.54},{"d":"2024-12-23","c":"Facebook","r":2.01,"m":1.54},{"d":"2024-12-23","c":"Naver","r":2.68,"m":2.79},{"d":"2024-12-24","c":"Google","r":2.76,"m":2.53},{"d":"2024-12-24","c":"Facebook","r":1.94,"m":1.56},{"d":"2024-12-24","c":"Naver","r":3.16,"m":2.83},{"d":"2024-12-25","c":"Google","r":2.23,"m":2.41},{"d":"2024-12-25","c":"Facebook","r":2.03,"m":1.78},{"d":"2024-12-25","c":"Naver","r":3.42,"m":2.89},{"d":"2024-12-26","c":"Google","r":2.7,"m":2.48},{"d":"2024-12-26","c":"Facebook","r":1.93,"m":1.99},{"d":"2024-12-26","c":"Naver","r":3.29,"m":2.94},{"d":"2024-12-27","c":"Google","r":2.84,"m":2.58},{"d":"2024-12-27","c":"Facebook","r":2.15,"m":2.02},{"d":"2024-12-27","c":"Naver","r":3.61,"m":3.1},{"d":"2024-12-28","c":"Google","r":2.58,"m":2.6},{"d":"2024-12-28","c":"Facebook","r":1.64,"m":1.96},{"d":"2024-12-28","c":"Naver","r":3.17,"m":3.21},{"d":"2024-12-29","c":"Google","r":2.88,"m":2.68},{"d":"2024-12-29","c":"Facebook","r":1.48,"m":1.88},{"d":"2024-12-29","c":"Naver","r":3.22,"m":3.22}];

    const campaignData = [
        {ch:"Naver Ads",  camp:"Naver_Brand",       cost:12584, rev:51067,  roas:4.06},
        {ch:"Google Ads", camp:"Google_Brand",       cost:15574, rev:53977,  roas:3.47},
        {ch:"Naver Ads",  camp:"Naver_Retargeting",  cost:8439,  rev:28934,  roas:3.43},
        {ch:"Google Ads", camp:"Google_Retargeting",  cost:10190, rev:30893,  roas:3.03},
        {ch:"Naver Ads",  camp:"Naver_Shopping",     cost:29896, rev:85926,  roas:2.87},
        {ch:"Facebook Ads",camp:"FB_Retargeting",    cost:11972, rev:29206,  roas:2.44},
        {ch:"Google Ads", camp:"Google_Generic",     cost:30631, rev:71056,  roas:2.32},
        {ch:"Facebook Ads",camp:"FB_Lookalike",      cost:25149, rev:50052,  roas:1.99},
        {ch:"Facebook Ads",camp:"FB_Interest",       cost:19735, rev:36016,  roas:1.83}
    ];

    // ===== 1. ROAS Bar Chart =====
    const roasBarCtx = document.getElementById('roasBarChart').getContext('2d');
    new Chart(roasBarCtx, {
        type: 'bar',
        data: {
            labels: ['Naver Ads', 'Google Ads', 'Facebook Ads'],
            datasets: [{
                label: 'ROAS',
                data: [3.26, 2.76, 2.03],
                backgroundColor: [COLORS.naver.bg, COLORS.google.bg, COLORS.facebook.bg],
                borderColor: [COLORS.naver.border, COLORS.google.border, COLORS.facebook.border],
                borderWidth: 2,
                borderRadius: 6,
                barPercentage: 0.6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: ctx => `ROAS: ${ctx.raw.toFixed(2)}x`
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 4,
                    ticks: { callback: v => v.toFixed(1) + 'x' },
                    grid: { color: '#f1f3f4' }
                },
                x: { grid: { display: false } }
            }
        }
    });

    // ===== 2. Revenue Pie Chart =====
    const pieCtx = document.getElementById('revenuePieChart').getContext('2d');
    new Chart(pieCtx, {
        type: 'doughnut',
        data: {
            labels: ['Naver Ads (37.96%)', 'Google Ads (35.67%)', 'Facebook Ads (26.37%)'],
            datasets: [{
                data: [165927, 155927, 115274],
                backgroundColor: [COLORS.naver.bg, COLORS.google.bg, COLORS.facebook.bg],
                borderColor: '#fff',
                borderWidth: 3,
                hoverOffset: 8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: { padding: 16, usePointStyle: true, pointStyle: 'circle' }
                },
                tooltip: {
                    callbacks: {
                        label: ctx => {
                            const v = ctx.raw;
                            const pct = (v / 437128 * 100).toFixed(1);
                            return `$${v.toLocaleString()} (${pct}%)`;
                        }
                    }
                }
            }
        }
    });

    // ===== 3. Daily ROAS Line Chart =====
    const dates = [...new Set(dailyData.map(d => d.d))];
    const channels = ['Google', 'Facebook', 'Naver'];
    const colorMap = { Google: COLORS.google, Facebook: COLORS.facebook, Naver: COLORS.naver };

    const lineDatasets = [];
    channels.forEach(ch => {
        const chData = dailyData.filter(d => d.c === ch);
        const col = colorMap[ch];
        // Daily ROAS (thin, transparent)
        lineDatasets.push({
            label: `${ch} Daily`,
            data: chData.map(d => d.r),
            borderColor: col.bg,
            backgroundColor: col.light,
            borderWidth: 1,
            pointRadius: 0,
            tension: 0.3,
            fill: false
        });
        // 7-day MA (thick, solid)
        lineDatasets.push({
            label: `${ch} 7d MA`,
            data: chData.map(d => d.m),
            borderColor: col.bg,
            backgroundColor: col.bg,
            borderWidth: 2.5,
            borderDash: [],
            pointRadius: 0,
            tension: 0.4,
            fill: false
        });
    });

    const lineCtx = document.getElementById('roasLineChart').getContext('2d');
    new Chart(lineCtx, {
        type: 'line',
        data: {
            labels: dates.map(d => d.slice(5)),  // MM-DD
            datasets: lineDatasets
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: { mode: 'index', intersect: false },
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        usePointStyle: true,
                        pointStyle: 'line',
                        padding: 12,
                        filter: item => item.text.includes('7d MA')
                    }
                },
                tooltip: {
                    callbacks: {
                        label: ctx => `${ctx.dataset.label}: ${ctx.raw.toFixed(2)}x`
                    }
                }
            },
            scales: {
                y: {
                    min: 0,
                    max: 7,
                    ticks: { callback: v => v.toFixed(1) + 'x' },
                    grid: { color: '#f1f3f4' }
                },
                x: {
                    ticks: {
                        maxRotation: 0,
                        autoSkip: true,
                        maxTicksLimit: 15
                    },
                    grid: { display: false }
                }
            }
        }
    });

    // ===== 4. Campaign Bubble Chart =====
    const bubbleCtx = document.getElementById('campaignBubbleChart').getContext('2d');
    const chColor = ch => {
        if (ch.includes('Naver')) return COLORS.naver;
        if (ch.includes('Google')) return COLORS.google;
        return COLORS.facebook;
    };

    new Chart(bubbleCtx, {
        type: 'bubble',
        data: {
            datasets: campaignData.map(c => ({
                label: c.camp,
                data: [{ x: c.cost / 1000, y: c.rev / 1000, r: c.roas * 4 }],
                backgroundColor: chColor(c.ch).bg + '99',
                borderColor: chColor(c.ch).border,
                borderWidth: 1.5
            }))
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: ctx => {
                            const d = ctx.raw;
                            const camp = ctx.dataset.label;
                            return [
                                camp,
                                `Cost: $${(d.x * 1000).toLocaleString()}`,
                                `Revenue: $${(d.y * 1000).toLocaleString()}`,
                                `ROAS: ${(d.r / 4).toFixed(2)}x`
                            ];
                        }
                    }
                }
            },
            scales: {
                x: {
                    title: { display: true, text: 'Cost ($K)', font: { size: 12 } },
                    grid: { color: '#f1f3f4' }
                },
                y: {
                    title: { display: true, text: 'Revenue ($K)', font: { size: 12 } },
                    grid: { color: '#f1f3f4' }
                }
            }
        }
    });
    </script>
</body>
</html>
